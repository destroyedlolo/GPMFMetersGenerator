/* QualityGaphic
 * Generate quality gaphic
 */

#include "QualityGfx.h"

#include <cstdio>
#include <cstdlib>
#include <cerrno>
#include <cstring>
#include <cmath>

/* GIMP RGBA C-Source image dump (Satellite.c) */

static struct {
  int  	 width;
  int  	 height;
  int  	 bytes_per_pixel; /* 2:RGB16, 3:RGB, 4:RGBA */ 
  unsigned char 	 pixel_data[40 * 36 * 4 + 1];
} imgSatellite = {
  40, 36, 4,
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\273\270\264\227\247\243"
  "\237\335\227\226\224\256\240\240\237\177\302\302\301=\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\307\303\277\226\305\300\273"
  "\377\310\305\302\377\300\277\276\377\235\234\233\316\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\311\306\304m\310\305\301\377"
  "\312\311\307\377\305\305\304\377\244\242\240\357\314\314\314\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\312\311\307G\312\311\310\377"
  "\305\305\304\377\262\261\256\377\234\232\227\377\315\315\315\017\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\313\312\310\040\305\304\303"
  "\377\261\260\255\377\235\233\225\377\207\204\177\377\306\305\304y\302\301"
  "\277c\303\303\302\012\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\311\306\305\004\251\247\244\207\273\271\266M\311\310\306\010\000"
  "\000\000\000\000\000\000\000\307\306\304V\267\266\263\377\234\232\224\377\207\204|\377"
  "nja\377\276\271\262\377\333\330\324\377\345\345\344\332\274\274\272%\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\275\267\260>\300\272\263\035\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\310\305"
  "\303\001\277\273\265\344\252\245\237\377\253\250\245\365\245\243\241\255\265"
  "\263\261\201\254\251\245\373\252\250\244\377\206\204|\377qnc\377a]Q\377\217"
  "\214\211\377\357\357\357\377\334\334\331\377\254\253\246\336\267\266\264"
  "\017\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\301\272\262\003\263\257\254\204\215\275\307\376\230\257\266\360\274\266"
  "\260^\306\275\271\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\306\302\275\232\304\300\272\377\310\305\302\377"
  "\311\310\307\377\221\217\214\377oic\377\232\225\220\377\226\222\216\377m"
  "ke\377ok`\377\314\312\311\377\235\233\230\377\232\227\220\377sod\377\252"
  "\250\243w\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\277\271\262\032\251\260\261\276\201\306\323\377y\316\334\377z\313\331\377"
  "\206\260\274\377\256\260\257\256\304\277\271\026\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\310\306\303\062\307\304\301"
  "\301\312\310\306\376\302\302\301\377\242\240\234\377upj\377\177{w\377\235"
  "\233\231\377\321\321\321\377\312\310\307\377\323\321\316\377\214\211\206"
  "\377]WN\377\227\221\210\377\261\256\251u\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\275\266\257B\231\261\267\346{\272\311\377w\260\302"
  "\377{\307\324\377x\274\314\377x\315\334\377{\313\331\377\240\250\256\351"
  "\300\273\265P\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\312\311\307\036\305\304\303u\261\260\254\334\211\205"
  "\200\377\070\063.\377\032\030\026\377|zw\377~}|\377okf\377`[V\377_ZT\377\240\236"
  "\232\340\260\257\254\066\254\254\250\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\262\256\253z\216\274\305\374z\320\335\377z\317\335\377w\266\306\377"
  "}\254\274\377y\310\327\377z\321\337\377~\266\306\377x\324\342\377\212\305"
  "\322\377\265\271\272\237\306\302\275\017\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\312\311\307\022\270\265\262~\250\244\240\303\256\253\247\330"
  "\255\253\250\361\214\207\202\377\240\235\233\377\202\201\201\377KF@\377\201"
  "~z\377XVS\377yto\377\300\272\263\377\262\255\250\377\236\234\231\377\227"
  "\225\222\346\210\205\200\241\231\227\222X\240\236\232\015\000\000\000\000\000\000\000\000"
  "\240\233\226\257\177\236\251\377z\314\332\377v\264\305\377{\314\332\377v"
  "\314\333\377}\267\307\377\177\252\274\377y\332\350\377t\331\351\377s\316"
  "\341\377{\322\343\377\244\302\314\340\303\300\273B\311\306\305\000\000\000\000\000"
  "\000\000\000\000\312\310\307\000\274\272\267Y\245\240\233\355\235\227\221\377\251\244"
  "\237\377\274\271\266\377\316\316\315\377\316\316\316\377\264\264\264\377"
  "\223\222\220\377A?=\377QJB\377\177}|\377jhf\377\277\271\262\377\305\301\274"
  "\377\310\306\303\377\313\312\311\377\272\272\270\377\216\214\207\377\210"
  "\204\177\200\000\000\000\000\000\000\000\000\302\275\261\001\244\236\230n\213\213\216\367z"
  "\274\313\377z\323\340\377~\310\326\377{\276\317\377t\316\337\377u\277\323"
  "\377w\313\336\377t\333\354\377q\341\363\377x\337\361\377\227\315\335\376"
  "\264\274\276\221\311\305\303\011\306\304\300\"\273\267\263\215\230\222\214"
  "\377\251\244\236\377\305\302\276\377\331\327\326\377\337\337\337\377\326"
  "\326\326\377\306\305\304\377\250\247\244\377ihd\377\060-&\377G@\071\377\220"
  "\216\214\377db`\377\227\223\216\377\306\302\277\377\312\310\306\377\311\310"
  "\310\377\266\265\263\377\237\236\230\377zwq\263\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\274\266\257)\227\224\220\316\202\245\261\377z\306\326\377u\330\350"
  "\377w\335\354\377p\307\335\377w\314\340\377p\324\352\377{\340\361\377|\332"
  "\357\377q\354\376\377r\341\364\377\227\260\272\331\234\227\222\361\215\207"
  "\177\377\244\236\227\377\305\300\273\377\350\347\346\377\365\365\364\377"
  "\352\352\352\377\323\323\322\377\251\250\245\377\212\210\203\377if_\377J"
  "E=\377\260\257\256\377tsq\377ID?\377\210\206\202\310\261\260\254W\272\271"
  "\266\251\272\271\270\360\254\253\247\377\227\225\217\377|yr\350\231\227\220"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\303\275\270\005\244\237\231\206\207\235"
  "\246\374w\321\342\377q\311\335\377u\342\362\377s\344\365\377}\324\351\377"
  "\201\321\350\377q\353\376\377q\354\377\377d\325\354\377\200\252\257\377\213"
  "\204|\377\220\211\202\377\246\241\233\377\274\271\265\377\346\345\344\377"
  "\370\370\370\377\345\345\345\377\275\275\272\377\213\211\204\377kia\377M"
  "J@\377~|x\377\257\256\253\377\220\216\210\377\244\243\240\226\261\260\255"
  "\020\000\000\000\000\000\000\000\000\243\242\233\006\240\236\231J\226\224\215\233\205\202{\306"
  "\231\226\220\003\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\270\263\255"
  "=\232\233\232\335w\306\330\377s\345\366\377z\332\355\377y\340\363\377m\352"
  "\377\377u\333\362\377k\320\350\377\200\252\260\377\213\204|\377\220\211\202"
  "\377\246\241\234\377\262\257\253\377[XR\377\260\257\255\377\315\314\313\377"
  "\313\312\310\377\230\227\222\377kha\377LI?\377\064\060$\377}{u\377\222\220"
  "\212\377sof\377\260\257\253M\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\305\300\272\016\250\243\236\237\222\264\276\377x\340\364\377n\354\377"
  "\377t\354\376\377g\331\361\377\177\242\250\377\213\204|\377\220\211\202\377"
  "\247\242\234\377\276\273\267\377\274\273\271\377\263\262\260\377URK\377\266"
  "\265\261\377\247\245\240\377trj\377LI?\377\064\060$\377B=\062\377\211\207\201"
  "\363\205\203{\377hcX\377\233\231\226m\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\310\300\274\000\266\262\255Q\235\257\265\354\177\335\360"
  "\377l\333\363\377\201\251\255\377\213\204}\377\220\211\202\377\247\242\235"
  "\377\315\313\310\377\247\246\243\377\303\302\300\377\272\271\266\377\271"
  "\270\264\377\215\214\207\377ome\377mj`\377\066\062&\377B>\062\377a[R\377\251"
  "\250\245h\265\264\261!\243\241\233u\241\237\234\071\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\306\303\277\030\251\251"
  "\247\304v\222\227\377\210\201y\377\220\211\202\377\247\242\235\377\325\323"
  "\320\377\346\346\345\377\343\342\342\377\270\267\265\377\276\275\272\377"
  "\215\213\206\377nkd\377QNE\377<\071-\377]XM\377^XN\377\221\216\211\335\271"
  "\271\266\010\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\310\304\302\001\253\247\241\264\245\236"
  "\227\377\253\245\236\377\250\243\236\377\302\276\271\377\275\272\267\377"
  "\341\340\340\377\340\340\337\377\310\307\305\377\215\213\206\377nkd\377Q"
  "NE\377\066\063'\377\061-\"\377kuw\377\177\271\306\377\223\256\266\365\237\244"
  "\250\264\252\250\244j\255\254\247\"\251\251\246\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\305\302\277\002\305\301\274O\301\274\266\306"
  "\277\271\262\377\301\273\264\377\272\265\260\377\331\326\323\377\344\343"
  "\341\377\312\310\305\377\246\242\235\377\304\302\277\377\215\213\206\377"
  "mkd\377QND\377\066\063'\377\060,!\377DPU\377y\305\322\377y\315\333\377w\272"
  "\312\377y\316\334\377~\262\301\377\215\266\277\377\223\250\260\332\242\242"
  "\237\215\235\233\225H\234\233\225\011\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\307\303\275"
  "\014\310\304\300\277\257\251\243\377\267\261\251\377\305\300\271\377\334\331"
  "\324\377\366\365\363\377\360\360\360\377\350\350\350\377\344\343\341\377"
  "\273\272\266\377\214\212\205\377mkc\377QND\377\066\063'\377:\066*\377>@B\377"
  "y\252\270\377z\270\310\377v\267\310\377y\316\334\377|\310\326\377}\275\314"
  "\377w\323\342\377v\313\333\377q\311\334\377\177\304\325\377\226\263\275\365"
  "\230\252\261\262\232\231\224l\216\214\205$\220\217\202\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\306\302\275G\334\331\326"
  "\377\273\276\304\377\266\270\274\377\307\304\277\377\364\363\362\377\377"
  "\377\377\377\376\376\376\377\346\346\344\377\273\272\267\377\243\242\235"
  "\377kia\377QND\377\066\062'\377;\066*\377ZVO\377y\270\304\377w\313\332\377v"
  "\266\310\377z\266\306\377|\264\304\377\201\250\270\377v\320\340\377w\322"
  "\341\377s\310\332\377s\332\353\377z\333\353\377}\317\343\377o\342\365\377"
  "z\337\361\377~\274\315\377v\245\262\330x~z\220~|sE\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\001\000\000\000\003\000\000\000\005\257\253\250\037\267\262\253\372\214\226\244\377"
  "M\201\254\377\217\252\302\377\325\330\331\377\371\371\371\377\357\356\355"
  "\377\325\324\321\377\260\257\252\377\202\177x\377dbY\377\066\062&\377;\066*"
  "\377VPF\377|\243\256\377z\320\335\377x\277\316\377z\314\332\377y\317\335"
  "\377~\262\301\377r\312\333\377w\274\316\377v\255\303\377v\312\334\377t\335"
  "\356\377\202\312\335\377v\347\367\377v\352\372\377g\327\361\377r\354\376"
  "\377p\354\377\377`\325\353\377iib\332\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\000\000"
  "\000\004hec\012\257\253\246\226\252\246\242\376\306\305\304\377\177\206\214\377"
  "$\202\264\377]\233\302\377\273\302\307\377\316\315\312\377\273\271\264\377"
  "\241\237\230\377vtj\377ZVJ\377GC\071\377TOD\377lf]\377\221\216\213\363\203"
  "\227\236\377\177\257\273\377y\315\333\377~\265\305\377x\317\336\377w\326"
  "\345\377q\302\325\377x\336\355\377r\330\352\377\211\300\322\377v\316\345"
  "\377s\332\360\377n\341\370\377p\345\372\377p\354\377\377v\356\377\377^\216"
  "\233\377yvmB\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\273\270\264\023\202\214"
  "\226\375\253\260\264\377\206\205\200\377FMN\377t\213\235\377\272\275\277"
  "\377v\250\306\377\222\235\241\377\234\232\223\377\207\205{\377nk_\377ZVJ"
  "\377|wn\377lf]\377\233\230\224\340rrqJ}}|W\211\210\206\251\210\213\217\361"
  "}\240\253\377v\310\332\377s\310\332\377z\334\352\377q\334\356\377{\322\345"
  "\377y\333\355\377n\346\371\377r\344\371\377~\325\355\377m\327\357\377j\334"
  "\362\377a\274\317\377rne\227\201\177u\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\257\267\276\205H\254\324\377BGE\377\207\201z\377\301\277\276"
  "\377\267\266\264\377kmk\377B\237\306\377nvv\377li]\377ieY\377}wl\377\203"
  "}u\377\224\221\216\340mmlO\000\000\000>\000\000\000=\000\000\000;A@??\207\207\204\202\210\210"
  "\205\323~\232\244\377w\304\326\377v\333\355\377{\320\344\377t\352\373\377"
  "x\356\375\377n\333\366\377t\356\377\377m\352\377\377g\324\352\377opi\340"
  "\200}t\016\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\307\306"
  "\277\000\245\250\250\271\202\202\201\377n\221\252\377\253\253\252\377kib\377"
  "VWS\377\070\257\335\377L\247\313\377YUJ\377\200zo\377\236\232\222\374\237"
  "\235\234\232hhhL\000\000\000>\000\000\000?\000\000\000=\000\000\000;\000\000\000\070\000\000\000\065\001\001\001\062}"
  "{xW\200~y\252\217\227\227\365\201\303\322\377p\343\370\377p\341\370\377u"
  "\352\374\377p\354\377\377w\357\377\377g\224\242\376zwnF\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\255\255\256\207l\243"
  "\302\377[\226\263\377/\230\275\377KG>\377\270\267\265\377\236\254\263\377"
  "\025\272\352\377c{\202\377\221\214\202\377\256\254\251\252\000\000\000\071\000\000\000"
  "<\000\000\000=\000\000\000>\000\000\000=\000\000\000:\000\000\000\070\000\000\000\065\000\000\000\062\000\000\000.\000\000\000*UT"
  "Q\061\177}w|\217\222\220\327\210\263\302\377|\333\360\377v\356\377\377m\303"
  "\324\377vrj\234\203\203z\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\304\302\276\012\232\267\310\274K\206\240\377s\216"
  "\234\377\226\227\230\377\254\253\250\377XUM\377\064\210\244\377`v{\377\237"
  "\233\225\373\203\203\203O\000\000\000\070\000\000\000:\000\000\000;\000\000\000;\000\000\000\071\000\000\000\067"
  "\000\000\000\066\000\000\000\064\000\000\000\061\000\000\000-\000\000\000*\000\000\000&\000\000\000\"\003\003\003\035{ysN\177"
  "|u\252x\224\236\371u}}\343\200}u\017\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\000\000\000\006ZXV\020\265\263\261S\257"
  "\261\264\217Z\262\331\377GW]\377\202\200{\357\224\221\213\356\216\213\203"
  "\377\244\242\240\223\000\000\000\064\000\000\000\066\000\000\000\067\000\000\000\067\000\000\000\060\000\000\000$"
  "\000\000\000\036\000\000\000(\000\000\000/\000\000\000/\000\000\000,\000\000\000(\000\000\000%\000\000\000!\000\000\000\035\000\000\000"
  "\031\000\000\000\025fe^$wum\060\000\000\000\005\000\000\000\002\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\013\000\000\000\022\000\000\000\026\021\022\021"
  "\032\237\253\262\202\214\235\246\352\245\244\243c//.*kkk:\000\000\000/\000\000\000\061"
  "\000\000\000\061\000\000\000,\000\000\000\037\000\000\000\020\000\000\000\006\000\000\000\003\000\000\000\012\000\000\000\030\000\000"
  "\000#\000\000\000(\000\000\000&\000\000\000#\000\000\000\037\000\000\000\034\000\000\000\030\000\000\000\025\000\000\000\021\000\000"
  "\000\015\000\000\000\011\000\000\000\005\000\000\000\002\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\001\000\000\000\005\000\000\000\014\000\000\000\023\000\000\000\030\000\000\000\034\000\000\000"
  "\037\000\000\000#\000\000\000&\000\000\000)\000\000\000)\000\000\000%\000\000\000\032\000\000\000\015\000\000\000\005\000\000\000\001"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\003\000\000\000\012\000\000\000\025\000\000\000\036\000\000\000\040\000\000"
  "\000\036\000\000\000\032\000\000\000\027\000\000\000\023\000\000\000\020\000\000\000\014\000\000\000\010\000\000\000\004\000\000\000"
  "\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\002\000\000\000\010\000\000\000\017\000\000\000\026\000\000\000\031\000\000\000\034\000\000\000\036\000\000\000\034"
  "\000\000\000\024\000\000\000\012\000\000\000\003\000\000\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\003\000\000\000\011\000\000\000\022\000\000\000\027\000\000\000\030\000\000\000\025\000"
  "\000\000\021\000\000\000\014\000\000\000\007\000\000\000\003\000\000\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\001\000\000\000\003"
  "\000\000\000\005\000\000\000\007\000\000\000\010\000\000\000\007\000\000\000\005\000\000\000\002\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\003\000\000\000\010\000\000\000\015\000\000\000\017\000\000\000\012\000\000\000\004\000\000\000\001\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000"
  "\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\002\000\000\000\003\000\000"
  "\000\001\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000",
};

QualityGfx::QualityGfx(GPVideo &v, GPX *h) : Gfx( 600,300, v, h ) {
	this->calcScales();
}

void QualityGfx::calcScales( void ){
		/* Label */
	cairo_text_extents_t extents;
	cairo_t *cr = cairo_create(this->background);

	cairo_select_font_face(cr, "sans", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_BOLD);
	cairo_set_font_size(cr, 35);
	cairo_text_extents(cr, "8888 (8)", &extents);
	this->offy = extents.height + 5;
	this->posLabel = this->SX - extents.x_advance - 55;

	cairo_select_font_face(cr, "sans", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_NORMAL);
	cairo_set_font_size(cr, 27);
	cairo_text_extents(cr, "8888", &extents);
	this->offx = extents.x_advance + 10;

		/* Scales */
	this->min_h = (((int)this->video.getMin().dop)/25)*25;
	this->max_h = (((int)this->video.getMax().dop)/25 + 1)*25;
	this->scale_w = (double)(this->SX - offx)/(double)this->video.getSampleCount();

	this->range_h = this->max_h - this->min_h;
	this->scale_h = (double)(this->SY - offy)/(double)this->range_h;
	this->delta_h = ((this->range_h/5)/25)*25;
	if(!this->delta_h)
		this->delta_h = this->range_h/5;

	cairo_destroy(cr);
}

void QualityGfx::drawGPMF(cairo_t *cr, int offset, uint32_t current){
	cairo_pattern_t *pat;

	if(offset){	// drawing shadow
		cairo_set_line_width(cr, 4);
		cairo_set_source_rgba(cr, 0,0,0, 0.55);
	} else {	// drawing path
		pat = cairo_pattern_create_linear(0,0, 0,this->SY);
		cairo_pattern_add_color_stop_rgb(pat, 0, 
			this->linearcomponent(this->max_h, 150, 0, 500, 1),
			this->linearcomponent(this->max_h, 150, 1, 500, 0),
		0);
		cairo_pattern_add_color_stop_rgb(pat, 1,
			this->linearcomponent(this->min_h, 150, 0, 500, 1),
			this->linearcomponent(this->min_h, 150, 1, 500, 0),
		0);
		cairo_set_source(cr, pat);

		cairo_set_line_width(cr, 2);
	}

	for(uint32_t i = 0; i < this->video.getSampleCount(); i++){
		int x = this->offx + i*this->scale_w + offset;
		int y = this->SY - (this->video[i].dop - this->min_h)*this->scale_h + offset;

		if(!i)	/* First plot */
			cairo_move_to(cr, x, y);
		else
			cairo_line_to(cr, x, y);
	}

	if(current != uint32_t(-1))
		cairo_stroke(cr);
	else
		cairo_stroke_preserve(cr);

	if(!offset)
		cairo_pattern_destroy(pat);
}

void QualityGfx::generateBackground( void ){
	cairo_surface_t *icn = cairo_image_surface_create_for_data (
		imgSatellite.pixel_data,
	    CAIRO_FORMAT_ARGB32,
		imgSatellite.width, imgSatellite.height,
		40*4
	);
	if(cairo_surface_status(icn) != CAIRO_STATUS_SUCCESS){
		fprintf(stderr, "Creating icon : %s\n", cairo_status_to_string(cairo_surface_status(icn)));
		cairo_surface_destroy(icn);
		icn = NULL;
	}

	cairo_t *cr = cairo_create(this->background);

	cairo_select_font_face(cr, "sans", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_NORMAL);
	cairo_set_font_size(cr, 27);
	cairo_set_source_rgba(cr, 1,1,1, 0.80);	/* Set white color */
	cairo_set_line_width(cr, 1);

	char t[8];
	for(int i = this->min_h; i <= this->max_h; i += this->delta_h){
		int y = this->SY - (i-this->min_h)*this->scale_h;
		sprintf(t, "%5d", i);

		cairo_move_to(cr, 3, y);
		cairo_show_text(cr, t);
		cairo_move_to(cr, this->offx, y);
		cairo_line_to(cr, this->SX, y);
	}
	cairo_stroke(cr);

	if(icn){
		cairo_save(cr);
		cairo_set_source_surface(cr, icn, 0, 0);
		cairo_rectangle(cr, this->posLabel-imgSatellite.width, this->offy+2, imgSatellite.width, imgSatellite.height);
		cairo_fill(cr);
		cairo_restore(cr);
	}

	this->drawGPMF(cr, 3);

	cairo_pattern_t *pat = cairo_pattern_create_linear(this->offx,this->SY - this->range_h*this->scale_h, this->offx,this->SY);
	cairo_pattern_add_color_stop_rgba(pat, 0, 0,0,0, 0.25);
	cairo_pattern_add_color_stop_rgba(pat, 1, 0,0,0, 0.05);
	cairo_set_source(cr, pat);

	cairo_line_to(cr, this->SX, this->SY);
	cairo_line_to(cr, this->offx, this->SY);
	cairo_line_to(cr, this->offx, this->SY - (this->video.getFirst().getAltitude() - this->min_h)*this->scale_h);

	cairo_fill(cr);

	cairo_pattern_destroy(pat);

	this->drawGPMF(cr, 0);

	cairo_destroy(cr);

	if(icn)
		cairo_surface_destroy(icn);
}

void QualityGfx::generateOneGfx(const char *fulltarget, char *filename, int index, GPMFdata &current){

		/*
		 * Initialise Cairo
		 */
	cairo_status_t err;

	cairo_surface_t *srf = cairo_image_surface_create(CAIRO_FORMAT_ARGB32, this->SX, this->SY);
	if(cairo_surface_status(srf) != CAIRO_STATUS_SUCCESS){
		puts("*F* Can't create Cairo's surface");
		exit(EXIT_FAILURE);
	}

	cairo_t *cr = cairo_create(srf);

	cairo_set_source_surface(cr, this->background, 0, 0);
	cairo_rectangle(cr, 0,0, this->SX, this->SY);
	cairo_fill(cr);
	cairo_stroke(cr);

		/* Display the label */
	char t[10];
	sprintf(t, "%5d (%c)", current.dop, current.gfix+'0');
	cairo_select_font_face(cr, "sans", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_BOLD);
	cairo_set_font_size(cr, 35);

	cairo_set_source_rgba(cr, 0,0,0, 0.55);
	cairo_move_to(cr, this->posLabel+2, this->offy+2);
	cairo_show_text(cr, t);
	cairo_stroke(cr);

	cairo_set_source_rgb(cr,
		this->linearcomponent(current.dop, 150, 0, 500, 1),
		this->linearcomponent(current.dop, 150, 1, 500, 0),
	0);
	cairo_move_to(cr, this->posLabel, this->offy);
	cairo_show_text(cr, t);
	cairo_stroke(cr);

		/* Display the spot */
	cairo_set_line_width(cr, 5);
	cairo_arc(cr, this->offx + index*this->scale_w, this->SY - (current.dop - this->min_h)*this->scale_h , 8, 0, 2 * M_PI);
	cairo_stroke_preserve(cr);
	cairo_set_source_rgb(cr, 0.8, 0.2, 0.2);
	cairo_fill(cr);

		/* Writing the image */
	sprintf(filename, "qual%07d.png", index);
	if(verbose)
		printf("*D* Writing '%s'\r", fulltarget);

	if((err = cairo_surface_write_to_png(srf, fulltarget)) != CAIRO_STATUS_SUCCESS){
		printf("*F* Writing surface : %s / %s\n", cairo_status_to_string(err), strerror(errno));
		exit(EXIT_FAILURE);
	}

		/* Cleaning */
	cairo_destroy(cr);
	cairo_surface_destroy(srf);
}

void QualityGfx::GenerateAllGfx( const char *fulltarget, char *filename ){
	Gfx::GenerateAllGfx( fulltarget, filename );

		/* Generate video */
	if(genvideo)
		generateVideo(fulltarget, filename, "qual", "quality");
}

double QualityGfx::linearcomponent( uint16_t val, uint16_t u1, double v1, uint16_t u2, double v2 ){
	if(u1 == u2)
		return v1;
	if(val < u1)
		return v1;
	if(val > u2)
		return v2;

	double a = (double)(v2-v1)/(double)(u2-u1);
	double b = v1 - a*u1;

	double res = a*val + b;
	if(res < 0)
		return 0;
	if(res > 255)
		return 255;
	else
		return res;
}
